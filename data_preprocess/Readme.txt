Borrowed from https://github.com/linan142857/BRCN/tree/master/src